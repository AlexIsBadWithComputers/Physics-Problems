(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     64600,       1579]
NotebookOptionsPosition[     62235,       1504]
NotebookOutlinePosition[     62612,       1520]
CellTagsIndexPosition[     62569,       1517]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
First we define a function which creates all our accessable states, \
mysteriously labelled \[OpenCurlyDoubleQuote]StateMaker\
\[CloseCurlyDoubleQuote], to add confusion as to what it does.\
\>", "Text",
 CellChangeTimes->{{3.600627472914975*^9, 3.6006275082822*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"k1", ",", "k2"}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CleanMap", "[", 
    RowBox[{"function_", ",", "variable_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Map", "[", 
     RowBox[{"function", ",", 
      RowBox[{"{", "variable", "}"}]}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"DoNothing", "[", "stuff_", "]"}], ":=", "1"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "function", " ", "is", " ", "for", " ", "the", " ", 
     "Vanilla", " ", "JC", " ", "model"}], "*)"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"State", "[", 
   RowBox[{"k1_", ",", "k2_", ",", "n_", ",", "s1_", ",", "s2_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"1", ",", "k1", ",", "k2", ",", "s1", ",", "s2", ",", "n"}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.6006225950501223`*^9, 3.600622601778756*^9}, 
   3.600622635897962*^9, {3.600626190094161*^9, 3.600626190954965*^9}, {
   3.60062632458113*^9, 3.600626363308791*^9}, {3.600626577238661*^9, 
   3.600626590682474*^9}, {3.6006269932570267`*^9, 3.600627007104425*^9}, {
   3.600627465129039*^9, 3.600627487674564*^9}, {3.6008072745916853`*^9, 
   3.600807287174061*^9}, {3.60114801556255*^9, 3.601148077371072*^9}, {
   3.6011481680656137`*^9, 3.601148169025709*^9}, 3.601148255522786*^9, {
   3.601239938572588*^9, 3.601239941413212*^9}, {3.601241277880584*^9, 
   3.601241283992321*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"StateMaker", "[", 
   RowBox[{"katom1_", ",", "katom2_", ",", "photons_"}], "]"}], ":=", " ", 
  RowBox[{"(*", 
   RowBox[{"This", " ", "defines", " ", "all", " ", "the", " ", "states"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Table", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"s1", "\[Equal]", "s2", "\[Equal]", "1"}], " ", "&&", " ", 
       RowBox[{"n", "\[GreaterEqual]", " ", "2"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"2", "\[Pi]", "*", "q"}], ",", 
        RowBox[{"2", "\[Pi]", "*", "q2"}], ",", "s1", ",", "s2", ",", 
        RowBox[{"n", "-", "2"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"s1", "\[Equal]", "s2", "\[Equal]", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"2", "\[Pi]", "*", "q"}], ",", 
          RowBox[{"2", "\[Pi]", "*", "q2"}], ",", "s1", ",", "s2", ",", "n"}],
          "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"s1", "\[NotEqual]", "s2"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"2", "\[Pi]", "*", "q"}], ",", 
            RowBox[{"2", "\[Pi]", "*", "q2"}], ",", "s1", ",", "s2", ",", 
            RowBox[{"n", "-", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"##", "&"}], "[", "]"}]}], "]"}]}], " ", 
       RowBox[{"(*", "Vanishingfunction", "*)"}], "\[IndentingNewLine]", 
       "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"q", ",", 
      RowBox[{"-", "katom1"}], ",", "katom1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"q2", ",", 
      RowBox[{"-", "katom2"}], ",", "katom2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s1", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"s2", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "photons", ",", "photons"}], "}"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.600622663601944*^9, 3.600622701962172*^9}, 
   3.600622838614973*^9, {3.6006231796092367`*^9, 3.600623583084054*^9}, {
   3.600623908814749*^9, 3.600623909902193*^9}, {3.60062395903045*^9, 
   3.600623959782435*^9}, {3.6006250274920597`*^9, 3.600625065391879*^9}, {
   3.60062521158119*^9, 3.6006252186924257`*^9}, {3.6006253013658237`*^9, 
   3.600625305621736*^9}, {3.60062538765574*^9, 3.60062539156665*^9}, {
   3.600625603966663*^9, 3.600625626966597*^9}, {3.600625743134742*^9, 
   3.6006257672712193`*^9}, {3.600625799095647*^9, 3.600625805599629*^9}, {
   3.600625856583049*^9, 3.6006259200231256`*^9}, {3.600625978508333*^9, 
   3.600625986091893*^9}, {3.6006260329525537`*^9, 3.600626107806675*^9}, {
   3.6006261984596987`*^9, 3.60062629268751*^9}, {3.600626375422204*^9, 
   3.600626432261883*^9}, {3.600626466294773*^9, 3.60062648529613*^9}, {
   3.600626547651265*^9, 3.6006265701427727`*^9}, {3.600626679335566*^9, 
   3.600626700344697*^9}, {3.600626785745092*^9, 3.600626791889146*^9}, {
   3.600627011137587*^9, 3.6006270280653553`*^9}, {3.600627317395788*^9, 
   3.600627317891835*^9}, {3.601148083408537*^9, 3.601148084405807*^9}, {
   3.601148148135955*^9, 3.60114824139355*^9}, {3.601148280374111*^9, 
   3.601148358962843*^9}, 3.601148538492176*^9, {3.601227160049363*^9, 
   3.60122716372948*^9}, {3.601227201422703*^9, 3.601227208145528*^9}, {
   3.6012410563740177`*^9, 3.601241057098333*^9}, {3.6016827407764997`*^9, 
   3.601682751034842*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MeStates", " ", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"StateMaker", "[", 
      RowBox[{"5", ",", "5", ",", "2"}], "]"}], ",", "4"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.60062358578619*^9, 3.600623597451494*^9}, {
   3.6006236695408382`*^9, 3.600623710228685*^9}, {3.6006237557572203`*^9, 
   3.60062375808947*^9}, {3.6006238544938717`*^9, 3.600623864245267*^9}, {
   3.600623911890806*^9, 3.600623951698965*^9}, {3.600625072210836*^9, 
   3.600625138003017*^9}, {3.600625170723907*^9, 3.60062526719788*^9}, {
   3.600625310577121*^9, 3.600625324556332*^9}, {3.6006254383652163`*^9, 
   3.600625443629003*^9}, {3.600625632395475*^9, 3.600625637661727*^9}, {
   3.600625771262517*^9, 3.600625790341367*^9}, {3.60062671375692*^9, 
   3.6006267825332127`*^9}, {3.60062683002682*^9, 3.60062685485883*^9}, {
   3.600627269438157*^9, 3.6006272745573053`*^9}, {3.600806139659836*^9, 
   3.6008061418996677`*^9}, 3.601148204610589*^9, {3.601148440489251*^9, 
   3.601148471811964*^9}, {3.601148546220735*^9, 3.601148551780479*^9}, {
   3.601149520506209*^9, 3.60114952840236*^9}, {3.601149657683015*^9, 
   3.601149660386258*^9}, {3.601149724955161*^9, 3.6011497271708927`*^9}, {
   3.6011501022296*^9, 3.601150131397637*^9}, {3.601150175598283*^9, 
   3.601150176885257*^9}, {3.601150679808498*^9, 3.601150684448998*^9}, {
   3.601150725832819*^9, 3.601150726937104*^9}, {3.6012318479458323`*^9, 
   3.6012318572975082`*^9}, {3.601240037626824*^9, 3.601240040650625*^9}, {
   3.601241059702882*^9, 3.601241060124619*^9}, {3.601682220584284*^9, 
   3.6016822237781887`*^9}, {3.601682790925806*^9, 3.6016827929121237`*^9}, {
   3.601682935111286*^9, 3.601682937970066*^9}, {3.601683191689045*^9, 
   3.6016831967723513`*^9}, {3.601686101381302*^9, 3.601686103863894*^9}, {
   3.601686671925668*^9, 3.6016866739570227`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MeStates", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.601682662884124*^9, 3.601682664906003*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{
    RowBox[{"-", "10"}], " ", "\[Pi]"}], ",", 
   RowBox[{
    RowBox[{"-", "10"}], " ", "\[Pi]"}], ",", "0", ",", "0", ",", "2"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.60168266523449*^9, {3.6016827699484587`*^9, 3.6016827741938*^9}, 
   3.6016829405562887`*^9, 3.6017390039493437`*^9}]
}, Open  ]],

Cell["\<\
Now, define operators for the TC Hamiltonian.\
\>", "Text",
 CellChangeTimes->{{3.600627452002969*^9, 3.6006274620902033`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"NOp", "[", "state_", "]"}], ":=", " ", 
  RowBox[{"{", 
   RowBox[{"ReplacePart", "[", 
    RowBox[{"state", ",", 
     RowBox[{"1", "\[Rule]", " ", 
      RowBox[{"state", "[", 
       RowBox[{"[", "6", "]"}], "]"}]}]}], "]"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.600627513425603*^9, 3.600627531901636*^9}, {
  3.600627574365706*^9, 3.600627609821101*^9}, {3.60062764658383*^9, 
  3.600627649983942*^9}, {3.600711312238328*^9, 3.6007113164858513`*^9}, {
  3.601229418694607*^9, 3.601229424605996*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Kin", "[", "state_", "]"}], ":=", " ", 
  RowBox[{"(*", 
   RowBox[{
   "Resolves", " ", "the", " ", "kinetic", " ", "energy", " ", "terms", " ", 
    "of", " ", "each", " ", "atom"}], "*)"}], 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"ReplacePart", "[", 
     RowBox[{"state", ",", 
      RowBox[{"1", "\[Rule]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"k1", "+", " ", 
          RowBox[{"state", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "2"]}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ReplacePart", "[", 
     RowBox[{"state", ",", 
      RowBox[{"1", "\[Rule]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"k2", "+", 
          RowBox[{"state", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "2"]}]}], "]"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.60062766139816*^9, 3.600627784467167*^9}, {
  3.6006278413322077`*^9, 3.600627853914547*^9}, {3.6008073138023167`*^9, 
  3.6008073157413387`*^9}, {3.601148577215193*^9, 3.6011485927982063`*^9}, {
  3.6011487806962757`*^9, 3.601148783719502*^9}, {3.601148840709147*^9, 
  3.6011488437334623`*^9}, {3.601682694442471*^9, 3.601682725178109*^9}, {
  3.601683090990396*^9, 3.60168309611985*^9}, {3.601683158353634*^9, 
  3.601683159858629*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MeStates", "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.600627595468067*^9, 3.60062759994525*^9}, {
  3.600629313929223*^9, 3.600629332393009*^9}, {3.600629476394162*^9, 
  3.600629484921585*^9}, {3.6006329820946007`*^9, 3.600632982141987*^9}, {
  3.600633085567568*^9, 3.600633085815239*^9}, {3.6006332260879908`*^9, 
  3.600633226135832*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{
    RowBox[{"-", "10"}], " ", "\[Pi]"}], ",", 
   RowBox[{
    RowBox[{"-", "10"}], " ", "\[Pi]"}], ",", "0", ",", "0", ",", "2"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.600627600199945*^9, {3.600629314757091*^9, 3.600629333029722*^9}, {
   3.6006294771747637`*^9, 3.600629485269813*^9}, 3.6006329835872707`*^9, 
   3.600633086212552*^9, 3.600633226997267*^9, 3.600710578549817*^9, 
   3.600810076412517*^9, 3.601143798460997*^9, 3.60122579407264*^9, 
   3.601239531756763*^9, 3.6017390039653544`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PaulZ", "[", "state_", "]"}], ":=", " ", 
   RowBox[{"(*", 
    RowBox[{"PaulZ", " ", "operator", " ", "on", " ", "given", " ", "state"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"state", "[", 
         RowBox[{"[", "5", "]"}], "]"}], " ", "\[Equal]", " ", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"state", ",", 
         RowBox[{"1", "\[Rule]", 
          RowBox[{
           RowBox[{"state", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/", 
           RowBox[{"-", "2"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"state", ",", 
         RowBox[{"1", "\[Rule]", 
          RowBox[{
           RowBox[{"state", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/", "2"}]}]}], "]"}]}], "]"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"state", "[", 
         RowBox[{"[", "4", "]"}], "]"}], " ", "\[Equal]", " ", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"state", ",", 
         RowBox[{"1", "\[Rule]", 
          RowBox[{
           RowBox[{"state", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/", 
           RowBox[{"-", "2"}]}]}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"state", ",", 
         RowBox[{"1", "\[Rule]", 
          RowBox[{
           RowBox[{"state", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/", "2"}]}]}], "]"}]}], "]"}]}], 
    "}"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.600629357724545*^9, 3.600629460877802*^9}, {
  3.6006295003182573`*^9, 3.60062950749443*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Emission", "[", 
    RowBox[{"state_", ",", "g_"}], "]"}], ":=", " ", 
   RowBox[{"(*", " ", 
    RowBox[{"emission", " ", "of", " ", "a", " ", "photon"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"state", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"5", " ", "\[Rule]", " ", "0"}], ",", 
           RowBox[{"6", " ", "\[Rule]", " ", 
            RowBox[{
             RowBox[{"state", "[", 
              RowBox[{"[", "6", "]"}], "]"}], "+", "1"}]}], ",", 
           RowBox[{"1", "\[Rule]", " ", 
            RowBox[{"g", "*", 
             SqrtBox[
              RowBox[{
               RowBox[{"state", "[", 
                RowBox[{"[", "6", "]"}], "]"}], "+", "1"}]]}]}]}], "}"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"##", "&"}], "[", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"state", "[", 
         RowBox[{"[", "4", "]"}], "]"}], " ", "\[Equal]", " ", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"4", " ", "\[Rule]", " ", "0"}], ",", 
           RowBox[{"6", " ", "\[Rule]", " ", 
            RowBox[{
             RowBox[{"state", "[", 
              RowBox[{"[", "6", "]"}], "]"}], "+", "1"}]}], ",", 
           RowBox[{"1", "\[Rule]", 
            RowBox[{"g", "*", " ", 
             SqrtBox[
              RowBox[{
               RowBox[{"state", "[", 
                RowBox[{"[", "6", "]"}], "]"}], "+", "1"}]]}]}]}], "}"}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
        "}"}]}], "]"}]}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"state", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", 
        RowBox[{"state", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"4", "\[Rule]", " ", "0"}], ",", 
           RowBox[{"5", "\[Rule]", "0"}], ",", 
           RowBox[{"6", "\[Rule]", " ", 
            RowBox[{
             RowBox[{"state", "[", 
              RowBox[{"[", "6", "]"}], "]"}], "+", "2"}]}], ",", 
           RowBox[{"1", "\[Rule]", " ", 
            RowBox[{
             RowBox[{"state", "[", 
              RowBox[{"[", "6", "]"}], "]"}], "+", "1"}]}]}], "}"}]}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"##", "&"}], "[", "]"}]}], "]"}], "*)"}], 
    "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.600629690419956*^9, 3.600629693759198*^9}, {
  3.600629812354656*^9, 3.6006298204188223`*^9}, {3.600632450899296*^9, 
  3.600632491093791*^9}, {3.60063261046159*^9, 3.600632865362274*^9}, {
  3.600633118228763*^9, 3.600633128692244*^9}, {3.6007121352911797`*^9, 
  3.600712230614031*^9}, {3.6007122791836967`*^9, 3.600712279386712*^9}, {
  3.600712835644567*^9, 3.6007128524686832`*^9}, {3.600713254240172*^9, 
  3.60071325582234*^9}, {3.600713522177104*^9, 3.60071354962565*^9}, {
  3.600718189480962*^9, 3.600718191384343*^9}, {3.600718545801765*^9, 
  3.600718555234252*^9}, {3.600719024581069*^9, 3.600719028327765*^9}, {
  3.600721014000815*^9, 3.60072101998265*^9}, {3.6007211088748903`*^9, 
  3.600721110733025*^9}, {3.600721561900908*^9, 3.600721569595023*^9}, {
  3.601239404230731*^9, 3.601239428166382*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Absorption", "[", 
   RowBox[{"state_", ",", "g_"}], "]"}], ":=", 
  RowBox[{"(*", 
   RowBox[{"absorption", " ", "of", " ", "a", " ", "photon"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"state", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", "0"}], " ", "&&", " ", 
       RowBox[{
        RowBox[{"state", "[", 
         RowBox[{"[", "6", "]"}], "]"}], " ", ">", " ", "0"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"state", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"5", " ", "\[Rule]", " ", "1"}], ",", 
          RowBox[{"6", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"state", "[", 
             RowBox[{"[", "6", "]"}], "]"}], "-", "1"}]}], ",", 
          RowBox[{"1", "\[Rule]", " ", 
           RowBox[{"g", "*", 
            SqrtBox[
             RowBox[{"state", "[", 
              RowBox[{"[", "6", "]"}], "]"}]]}]}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"##", "&"}], "[", "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"state", "[", 
         RowBox[{"[", "4", "]"}], "]"}], " ", "\[Equal]", " ", "0"}], " ", "&&",
        " ", 
       RowBox[{
        RowBox[{"state", "[", 
         RowBox[{"[", "6", "]"}], "]"}], ">", "0"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"state", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"4", " ", "\[Rule]", " ", "1"}], ",", 
          RowBox[{"6", " ", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"state", "[", 
             RowBox[{"[", "6", "]"}], "]"}], "-", "1"}]}], ",", 
          RowBox[{"1", "\[Rule]", " ", 
           RowBox[{"g", "*", 
            SqrtBox[
             RowBox[{"state", "[", 
              RowBox[{"[", "6", "]"}], "]"}]]}]}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"state", "[", 
         RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], " ", "&&", 
       RowBox[{
        RowBox[{"state", "[", 
         RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", "0"}], " ", "&&", " ", 
       RowBox[{
        RowBox[{"state", "[", 
         RowBox[{"[", "6", "]"}], "]"}], "\[GreaterEqual]", " ", "2"}]}], ",",
       "\[IndentingNewLine]", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"state", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"4", "\[Rule]", " ", "1"}], ",", 
          RowBox[{"5", "\[Rule]", "1"}], ",", 
          RowBox[{"6", "\[Rule]", " ", 
           RowBox[{
            RowBox[{"state", "[", 
             RowBox[{"[", "6", "]"}], "]"}], "-", "2"}]}], ",", 
          RowBox[{"1", "\[Rule]", " ", 
           RowBox[{"state", "[", 
            RowBox[{"[", "6", "]"}], "]"}]}]}], "}"}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"##", "&"}], "[", "]"}]}], "]"}], "*)"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.600632900674241*^9, 3.600632960098435*^9}, {
   3.600633131364805*^9, 3.6006331367800503`*^9}, {3.6006332360691423`*^9, 
   3.600633238957487*^9}, {3.60071175127312*^9, 3.60071175411278*^9}, {
   3.600712290412747*^9, 3.600712366720092*^9}, {3.600712417471208*^9, 
   3.600712456495158*^9}, {3.600712499217906*^9, 3.6007125007135267`*^9}, {
   3.600712560899836*^9, 3.600712562115651*^9}, {3.600712732373515*^9, 
   3.600712737260304*^9}, {3.600712797749477*^9, 3.600712801997096*^9}, {
   3.600713256953025*^9, 3.60071325773785*^9}, {3.6007135132424297`*^9, 
   3.6007135153746223`*^9}, {3.6007181959431877`*^9, 3.60071819709838*^9}, {
   3.600718528117186*^9, 3.600718544252837*^9}, {3.600719009190927*^9, 
   3.6007190179611197`*^9}, 3.600719613998543*^9, {3.60072099461532*^9, 
   3.60072100158453*^9}, {3.600721075428116*^9, 3.600721082164673*^9}, {
   3.600721550471199*^9, 3.600721558229472*^9}, 3.600806476749077*^9, {
   3.600809662912097*^9, 3.6008096635916*^9}, {3.601239412527882*^9, 
   3.6012394240950003`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Emission", "[", 
  RowBox[{"MeStates", "[", 
   RowBox[{"[", "10", "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.601148895999234*^9, 3.60114894569158*^9}}],

Cell[BoxData[
 RowBox[{"Emission", "[", 
  RowBox[{"{", 
   RowBox[{"1", ",", 
    RowBox[{
     RowBox[{"-", "10"}], " ", "\[Pi]"}], ",", 
    RowBox[{
     RowBox[{"-", "6"}], " ", "\[Pi]"}], ",", "0", ",", "1", ",", "1"}], 
   "}"}], "]"}]], "Output",
 CellChangeTimes->{{3.6011489067648478`*^9, 3.60114894602701*^9}, 
   3.601225794207254*^9, 3.601239531812847*^9, 3.601739003983366*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FC", "[", "state_", "]"}], ":=", " ", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "function", " ", "takes", " ", "the", " ", "emission", " ", 
     "and", " ", "absorption", " ", "stuff", " ", "and", " ", "changes", " ", 
     "the", " ", "momentum", " ", "states", " ", "accordingly"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "@", "state"}], " ", "\[Equal]", "2"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"ReplacePart", "[", 
            RowBox[{
             RowBox[{"state", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
             RowBox[{"j", " ", "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"state", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], "+", 
                RowBox[{"2", "\[Pi]"}]}], ")"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{
             RowBox[{"state", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", " ", 
             RowBox[{"j", "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"state", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j"}], "]"}], "]"}], "-", 
                RowBox[{"2", "\[Pi]"}]}], ")"}]}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "2", ",", "3"}], "}"}]}], "]"}], ",", "2"}], 
      "]"}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", "state"}], " ", "\[Equal]", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"ReplacePart", "[", 
              RowBox[{
               RowBox[{"state", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", " ", 
               RowBox[{"i", " ", "\[Rule]", 
                RowBox[{"(", " ", 
                 RowBox[{
                  RowBox[{"state", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], "+", 
                  RowBox[{"2", "\[Pi]"}]}], ")"}]}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"ReplacePart", "[", 
              RowBox[{
               RowBox[{"state", "[", 
                RowBox[{"[", "1", "]"}], "]"}], ",", 
               RowBox[{"i", "\[Rule]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"state", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "i"}], "]"}], "]"}], " ", "-", " ", 
                  RowBox[{"2", "\[Pi]"}]}], ")"}]}]}], "]"}]}], 
            "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", "3"}], "}"}]}], "]"}], ",", "1"}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"##", "&"}], "[", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.600633256188122*^9, 3.6006332702068787`*^9}, {
   3.600633361207479*^9, 3.600633470209256*^9}, {3.600633562298253*^9, 
   3.600633731880177*^9}, {3.600633879425804*^9, 3.6006338821525707`*^9}, {
   3.600634028329361*^9, 3.600634029713812*^9}, {3.6006341504346724`*^9, 
   3.600634151683517*^9}, {3.600634478597237*^9, 3.6006344803724117`*^9}, {
   3.600634550957243*^9, 3.6006345610373707`*^9}, {3.600634847158216*^9, 
   3.600635034161871*^9}, {3.600635069676114*^9, 3.600635136175027*^9}, {
   3.600635758883524*^9, 3.6006357643706493`*^9}, {3.600636186181581*^9, 
   3.600636198290319*^9}, {3.60063628197087*^9, 3.6006363242722397`*^9}, {
   3.600636385215096*^9, 3.600636388689506*^9}, {3.6006364865807877`*^9, 
   3.6006364956182327`*^9}, {3.600636532333404*^9, 3.600636690458803*^9}, {
   3.600636724116345*^9, 3.600636797308567*^9}, {3.600636837526062*^9, 
   3.600636840196822*^9}, {3.6007132749049253`*^9, 3.600713321741982*^9}, {
   3.6007134601819887`*^9, 3.6007134612136793`*^9}, {3.6007186925464687`*^9, 
   3.6007186996771517`*^9}, {3.6007187402443943`*^9, 3.600718788601945*^9}, {
   3.600718931154764*^9, 3.600718990785659*^9}, {3.600719038678152*^9, 
   3.6007190645333548`*^9}, {3.600719104133896*^9, 3.600719139498271*^9}, {
   3.600719292414678*^9, 3.600719334091591*^9}, {3.600719471191429*^9, 
   3.600719528990932*^9}, {3.600719572074394*^9, 3.600719574331938*^9}, {
   3.600719654692645*^9, 3.600719747071721*^9}, {3.60071986746761*^9, 
   3.600719870806283*^9}, {3.600719925739856*^9, 3.6007199456745863`*^9}, {
   3.600720027390584*^9, 3.600720044112378*^9}, {3.6007201472456512`*^9, 
   3.6007202035382957`*^9}, {3.600720304396826*^9, 3.6007203891874*^9}, 
   3.600720448962522*^9, {3.600720534595561*^9, 3.600720535213887*^9}, {
   3.600720775854617*^9, 3.600720778987596*^9}, {3.600721059946897*^9, 
   3.600721101365484*^9}, {3.600721267626966*^9, 3.600721269420371*^9}, {
   3.6007216839598627`*^9, 3.600721688271723*^9}, {3.600806561925106*^9, 
   3.6008065668217077`*^9}, {3.600810045425869*^9, 3.600810056693973*^9}, {
   3.601148735493272*^9, 3.601148760068344*^9}, {3.601150207501109*^9, 
   3.60115023500406*^9}, {3.601150363218646*^9, 3.601150370317936*^9}, {
   3.6012305301298437`*^9, 3.60123058137964*^9}, {3.601231306054008*^9, 
   3.601231324060399*^9}, {3.601231457006452*^9, 3.601231461190468*^9}, {
   3.601231539031404*^9, 3.6012315608955097`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ActOnState", "[", 
    RowBox[{"state_", ",", "g_"}], "]"}], ":=", " ", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "effect", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"effect", " ", "=", " ", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"effect", ",", " ", 
        RowBox[{"Kin", "[", "state", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"effect", ",", 
        RowBox[{"NOp", "[", "state", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"effect", ",", 
        RowBox[{"PaulZ", "[", "state", "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"effect", ",", 
        RowBox[{"FC", "[", 
         RowBox[{"Emission", "[", 
          RowBox[{"state", ",", "g"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"AppendTo", "[", 
       RowBox[{"effect", ",", 
        RowBox[{"FC", "[", 
         RowBox[{"Absorption", "[", 
          RowBox[{"state", ",", "g"}], "]"}], "]"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"{", "effect", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.600636984230908*^9, 3.600637013877782*^9}, {
   3.600637121238099*^9, 3.600637316084487*^9}, {3.600711258251623*^9, 
   3.600711258795656*^9}, {3.600711436733438*^9, 3.600711444644293*^9}, {
   3.60071159838411*^9, 3.600711659638324*^9}, {3.600712970612179*^9, 
   3.600712972977333*^9}, {3.600719243724413*^9, 3.6007192547170763`*^9}, {
   3.6007205828157682`*^9, 3.600720660039012*^9}, 3.600806476758988*^9, {
   3.6012315799363403`*^9, 3.60123160100353*^9}, {3.601239442530698*^9, 
   3.601239484504141*^9}, {3.601683106508274*^9, 3.601683115786983*^9}, {
   3.601683149780497*^9, 3.601683153243848*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Function", " ", "to", " ", "act", " ", "the", " ", "Hamiltonian", " ", 
   "on", " ", "a", " ", "given", " ", "state", " ", "and", " ", "flatten", 
   " ", "it", " ", 
   RowBox[{"appropriately", "."}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.6008083894135847`*^9, 3.600808408199897*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HState", "[", 
    RowBox[{"state_", ",", "g_"}], "]"}], ":=", " ", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"ActOnState", "[", 
      RowBox[{"state", ",", "g"}], "]"}], ",", "2"}], "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.60080819461383*^9, 3.60080823789212*^9}, {
   3.600808411006035*^9, 3.600808414318552*^9}, {3.6012315647419443`*^9, 
   3.601231574771456*^9}, {3.601231606237647*^9, 3.6012316098641167`*^9}, {
   3.601239467375239*^9, 3.601239472199676*^9}, {3.601683121404332*^9, 
   3.601683148241355*^9}, 3.601687200768518*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"KCheck", "[", 
    RowBox[{"act_", ",", "raw_"}], "]"}], ":=", " ", 
   RowBox[{"(*", 
    RowBox[{"Off", " ", "diagonal", " ", "terms"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"raw", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "==", 
       RowBox[{"act", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], " ", "&&", " ", 
      RowBox[{
       RowBox[{"raw", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "==", 
       RowBox[{"act", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", "1", 
     ",", "\[IndentingNewLine]", "0"}], "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.6008102825514183`*^9, 3.600810338010116*^9}, {
   3.6008104086113863`*^9, 3.600810425769264*^9}, {3.6011458975200853`*^9, 
   3.601145976560948*^9}, {3.601146232706538*^9, 3.601146237561898*^9}, {
   3.601146280994521*^9, 3.6011462876443787`*^9}, {3.601147636001563*^9, 
   3.601147706385482*^9}, {3.601149015313979*^9, 3.6011490301898108`*^9}, {
   3.601149234130856*^9, 3.601149281034151*^9}, 3.601149355819664*^9, {
   3.601150007046219*^9, 3.601150007086803*^9}, {3.601150199503763*^9, 
   3.601150199711358*^9}, {3.6011502576241207`*^9, 3.601150261567895*^9}, {
   3.601150373280198*^9, 3.60115037525329*^9}, 3.601226057576496*^9, {
   3.601231635161848*^9, 3.601231640282497*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Finds", " ", "all", " ", "non", " ", "zero", " ", "terms"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IsItZero", "[", 
     RowBox[{"raw_", ",", "act_"}], "]"}], ":=", " ", 
    RowBox[{"Block", "[", " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "total", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"total", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"raw", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", 
             RowBox[{"act", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "4"}], "]"}], "]"}]}], "&&", 
            RowBox[{
             RowBox[{"raw", "[", 
              RowBox[{"[", "5", "]"}], "]"}], "\[Equal]", 
             RowBox[{"act", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "5"}], "]"}], "]"}]}], " ", "&&", " ", 
            RowBox[{
             RowBox[{"raw", "[", 
              RowBox[{"[", "6", "]"}], "]"}], "\[Equal]", 
             RowBox[{"act", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "6"}], "]"}], "]"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"total", ",", 
             RowBox[{
              RowBox[{"act", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], "*", 
              RowBox[{"KCheck", "[", 
               RowBox[{
                RowBox[{"act", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], ",", "raw"}], "]"}]}]}], 
            "]"}], ",", "\[IndentingNewLine]", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"total", ",", "0"}], "]"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "[", "act", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"total", " ", "=", " ", 
        RowBox[{"Total", "[", "total", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"{", "total", "}"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.600808439923707*^9, 3.600808526048881*^9}, {
  3.6008086163404913`*^9, 3.600808636164118*^9}, {3.600809331704338*^9, 
  3.60080947722001*^9}, {3.600809531836692*^9, 3.6008095319079123`*^9}, {
  3.600810173800527*^9, 3.600810227007959*^9}, {3.600810473961176*^9, 
  3.600810482528665*^9}, {3.601145995708066*^9, 3.6011460124368343`*^9}, {
  3.601149131093623*^9, 3.601149144997205*^9}, {3.60114920465438*^9, 
  3.601149229205555*^9}, {3.601150290699189*^9, 3.601150319171129*^9}, {
  3.601231650365418*^9, 3.601231700021357*^9}, {3.6012319601672697`*^9, 
  3.60123196866364*^9}, {3.6012393745170116`*^9, 3.601239379484618*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"HamiltonianShmamiltonain", "[", 
    RowBox[{"states_", ",", "g_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"First", "@", 
        RowBox[{"IsItZero", "[", 
         RowBox[{
          RowBox[{"states", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"HState", "[", 
           RowBox[{
            RowBox[{"states", "[", 
             RowBox[{"[", "j", "]"}], "]"}], ",", "g"}], "]"}]}], "]"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "states", "]"}]}], "}"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.600807847362216*^9, 3.600807886508251*^9}, {
  3.6008081294351463`*^9, 3.6008081835105133`*^9}, {3.6008082415030813`*^9, 
  3.600808285488626*^9}, {3.600808430977605*^9, 3.600808435328608*^9}, {
  3.600808659995112*^9, 3.6008086987870607`*^9}, {3.600808760419668*^9, 
  3.600808900645705*^9}, {3.600809030902788*^9, 3.600809143329794*^9}, {
  3.6008092326018*^9, 3.600809235392139*^9}, {3.600809293379196*^9, 
  3.60080929398459*^9}, {3.600809555587777*^9, 3.600809637217553*^9}, {
  3.600809759760446*^9, 3.6008098168399982`*^9}, {3.600809857579728*^9, 
  3.600809861778664*^9}, {3.60081010174638*^9, 3.600810106995454*^9}, {
  3.601231614623929*^9, 3.601231619855402*^9}, {3.601231975693128*^9, 
  3.601232040948884*^9}, {3.601232168565104*^9, 3.601232192834942*^9}, {
  3.601239369590748*^9, 3.601239372262342*^9}, {3.6012394982180243`*^9, 
  3.601239505858637*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FastHam", "[", 
   RowBox[{"states_", ",", "g_"}], "]"}], ":=", " ", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Ham", ",", "option"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Do", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"option", " ", "=", " ", 
           RowBox[{"First", "@", 
            RowBox[{"IsItZero", "[", 
             RowBox[{
              RowBox[{"states", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"HState", "[", 
               RowBox[{
                RowBox[{"states", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", "g"}], "]"}]}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"option", " ", "\[NotEqual]", " ", "0"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Ham", " ", "=", " ", 
             RowBox[{"SparseArray", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"i", ",", "j"}], "}"}], " ", "\[Rule]", " ", 
               "option"}], "]"}]}], ",", "\[IndentingNewLine]", "Null"}], 
           "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "@", "states"}]}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "states"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "Ham", "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.601673977777207*^9, 3.6016741165598993`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"thing", "=", " ", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"N", "@", 
      RowBox[{"HamiltonianShmamiltonain", "[", 
       RowBox[{"MeStates", ",", "1"}], "]"}]}], ",", "40"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJwdzU9I2nEABXAZdNDVCJpmji0CWYO6rJHGZm4/6uAgzMkoixZz1Qhr08tk
ULAOUwp2GBYkaCA2/6AytmgMfxHCtsNInVom1BwbaNBcztFcSRju+76Hx4f3
Lq/pgV49dobD4YhJ4GU9z1LZyjGdI+/mYTcTXIRziRU7fJlu2IGl0otdOF/R
HkDTQfkvHDLKqznJHONz/KDuMG8b4VPvb+qCqri4TEwHm63wm7WO/4rYygvV
Q0P0Y9BFLCe716E3FY7AzzZNHJpF7Xvw+pRlH+o0kSJsdQv/0b1WIXYTJ+Me
6uzN2xqYKbvvwQBr0cI59QZ1Mxg4G8avPEN1Psvyaf8uE8Dx2mMd/HCtbwI+
jin1kO19Y4AK7sXX8FJygDp43lwTIXK1qXOQfTJ8AnX7zCn81CMZjRJnutJj
MGS7cwgdtzTUo3yB/wV/uxIBdMb7L8DY11QjzF71hBJEU5ufuioSZuB4uiML
lfmHUt92jmlT+Drg5t0ZGbRXPeqEZtkNFXR0rVN/VkxD0PDcfB8u+FlXgXil
ReqGjjU2Ao3+93E4nbL9gsXZJeqoUT79h8jb66P+BzXdXR4=
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"k1", ",", "k2"}], "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.601683340545429*^9, 3.601683367616365*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"garbage", " ", "=", " ", 
  RowBox[{"SparseArray", "[", 
   RowBox[{"SetPrecision", "[", 
    RowBox[{
     RowBox[{"N", "@", "thing"}], ",", "40"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.601682063100235*^9, 3.6016820736043453`*^9}, {
  3.601682131409848*^9, 3.601682131729822*^9}, {3.6018250191799545`*^9, 
  3.6018250622263308`*^9}, {3.601825724028428*^9, 3.601825724077458*^9}, {
  3.601826869690961*^9, 3.6018268705785503`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"SparseArray", "[", 
   RowBox[{
    InterpretationBox[
     RowBox[{"\<\"<\"\>", "\[InvisibleSpace]", "4004", 
      "\[InvisibleSpace]", "\<\">\"\>"}],
     SequenceForm["<", 4004, ">"],
     Editable->False], ",", 
    RowBox[{"{", 
     RowBox[{"484", ",", "484"}], "}"}]}], "]"}],
  False,
  Editable->False]], "Output",
 CellChangeTimes->{3.6018257247298903`*^9, 3.601826382083931*^9, 
  3.601826870934785*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"garbage", "[", 
  RowBox[{"[", 
   RowBox[{"1", ",", "1"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.601825914979576*^9, 3.6018259176703606`*^9}}],

Cell[BoxData[
 RowBox[{"1.`40.", "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "31.41592653589793115997963468544185161590576171875`40."}], 
     "+", "k1"}], ")"}], "2"], "+", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "31.41592653589793115997963468544185161590576171875`40."}], 
     "+", "k2"}], ")"}], "2"]}]], "Output",
 CellChangeTimes->{3.601825926831196*^9, 3.601826384252371*^9, 
  3.6018268740248346`*^9}]
}, Open  ]],

Cell[BoxData[
 TagBox[
  RowBox[{"SparseArray", "[", 
   RowBox[{
    InterpretationBox[
     RowBox[{
     "\"\<<\>\"", "\[InvisibleSpace]", "4004", "\[InvisibleSpace]", 
      "\"\<>\>\""}],
     SequenceForm["<", 4004, ">"],
     Editable->False], ",", 
    RowBox[{"{", 
     RowBox[{"484", ",", "484"}], "}"}]}], "]"}],
  False,
  Editable->False]], "Input",
 CellChangeTimes->{{3.601825080138275*^9, 3.6018250833193874`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"SetPrecision", "[", 
   RowBox[{
    RowBox[{"Eigenvalues", "[", 
     RowBox[{"garbage", ",", 
      RowBox[{"-", "1"}]}], "]"}], ",", "20"}], "]"}], "//", 
  "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.601682107456195*^9, 3.6016821261054688`*^9}, {
  3.601682512494343*^9, 3.601682512972912*^9}, {3.6018250887385993`*^9, 
  3.6018251167249575`*^9}, {3.60182572992634*^9, 3.601825729977374*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.37090749999999994557242644077632576227`6.157608065665907", ",", 
   RowBox[{
   "{", "0.396111484631540078956638490295891647093365765942369123737`20.", 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6016821208335867`*^9, 3.601682165966249*^9}, {
   3.601682308712311*^9, 3.60168232814377*^9}, {3.6016825138873367`*^9, 
   3.601682526128647*^9}, 3.601739377755701*^9, {3.601825089891363*^9, 
   3.6018251170972004`*^9}, 3.601825732430997*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Eigenvalues", "[", 
   RowBox[{"garbage", ",", 
    RowBox[{"-", "1"}]}], "]"}], "//", "AbsoluteTiming"}]], "Input",
 CellChangeTimes->{{3.6016821420027437`*^9, 3.601682159989911*^9}, {
  3.6016825184308853`*^9, 3.601682519159383*^9}, {3.601825470692214*^9, 
  3.6018254756145377`*^9}, {3.601825738673912*^9, 3.60182574400745*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.21380369999999992991490671556675806642`6.104748370282428", ",", 
   RowBox[{
   "{", "0.396111484631540078956638490295891647093365765942369123737`20.", 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.601682160221444*^9, 3.6016821684057837`*^9}, {
   3.601682316894573*^9, 3.601682319350298*^9}, {3.601682519714674*^9, 
   3.601682527385232*^9}, 3.6018257462049065`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakePlot", "[", 
   RowBox[{"Ham_", ",", "levels_"}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Plotarray", ",", "energy", ",", "Plots"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Plotarray", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"index", ",", "1", ",", 
          RowBox[{"Abs", "@", "levels"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Plots", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"k2", " ", "=", " ", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{"i", ",", "40"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"k1", "=", 
            RowBox[{"SetPrecision", "[", 
             RowBox[{"j", ",", "40"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"energy", " ", "=", " ", 
            RowBox[{"SetPrecision", "[", 
             RowBox[{
              RowBox[{"Eigenvalues", "[", 
               RowBox[{
                RowBox[{"N", "@", "Ham"}], ",", "levels"}], "]"}], ",", 
              "40"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{
                RowBox[{"Plotarray", "[", 
                 RowBox[{"[", "d", "]"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"N", "@", "k1"}], ",", 
                  RowBox[{"energy", "[", 
                   RowBox[{"[", "d", "]"}], "]"}]}], "}"}]}], "]"}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"d", ",", "1", ",", 
               RowBox[{"Length", "@", "energy"}]}], "}"}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{
             RowBox[{"-", "2"}], "\[Pi]"}], ",", 
            RowBox[{"2", "\[Pi]"}], ",", 
            RowBox[{"\[Pi]", "/", "50"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"Plots", ",", "\[IndentingNewLine]", 
          RowBox[{"ListLinePlot", "[", 
           RowBox[{"Plotarray", ",", " ", "\[IndentingNewLine]", 
            RowBox[{"Ticks", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], "\[Pi]"}], ",", 
                RowBox[{"2", "\[Pi]"}], ",", 
                RowBox[{"\[Pi]", "/", "4"}]}], "]"}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", " ", 
             RowBox[{"{", "600", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], "\[Pi]"}], ",", 
                 RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "100"}], "}"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AxesLabel", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\!\(\*SubscriptBox[\(k\), \(2\)]\)\>\"", ",", 
               "\"\<Energy\>\""}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Plotarray", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"index", ",", "1", ",", 
             RowBox[{"Abs", "@", "levels"}]}], "}"}]}], "]"}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"-", "2"}], "\[Pi]"}], ",", 
         RowBox[{"2", "\[Pi]"}], ",", 
         RowBox[{"\[Pi]", "/", "50"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "Plots", "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.601683398557014*^9, 3.6016839338002453`*^9}, {
   3.601684154486113*^9, 3.6016842825127296`*^9}, {3.601684317675511*^9, 
   3.6016843287241917`*^9}, {3.601684391613222*^9, 3.601684534178829*^9}, {
   3.601684616294759*^9, 3.601684664255686*^9}, {3.601684877090928*^9, 
   3.6016848812577553`*^9}, {3.601684916669764*^9, 3.601684961754777*^9}, {
   3.601684992442711*^9, 3.601684994844946*^9}, {3.601685037923542*^9, 
   3.6016850386753693`*^9}, {3.601685159368866*^9, 3.6016851606523933`*^9}, {
   3.601685336957605*^9, 3.601685356964319*^9}, {3.601685388486298*^9, 
   3.601685391092964*^9}, 3.60168547806977*^9, {3.601685639000269*^9, 
   3.601685639144096*^9}, 3.601685832186117*^9, {3.601685933831361*^9, 
   3.601685937499111*^9}, {3.601686158193728*^9, 3.601686178492653*^9}, {
   3.601686526617588*^9, 3.601686615579404*^9}, {3.601686647402679*^9, 
   3.601686655713616*^9}, {3.601687274439891*^9, 3.601687277695283*^9}, {
   3.601688284514295*^9, 3.601688293097682*^9}, {3.601688341533267*^9, 
   3.601688347721271*^9}, {3.6017412580887423`*^9, 3.6017412660675344`*^9}, {
   3.6017414225548487`*^9, 3.601741427907398*^9}, {3.6017418948533354`*^9, 
   3.6017419832385774`*^9}, {3.601742178947546*^9, 3.601742180745739*^9}, {
   3.6017424983682575`*^9, 3.6017425104464226`*^9}, {3.6017426167776933`*^9, 
   3.6017426355179396`*^9}, {3.601742800467296*^9, 3.6017428414430704`*^9}, {
   3.601743259925067*^9, 3.601743259981104*^9}, {3.6017434940640783`*^9, 
   3.601743497728506*^9}, {3.6017437076223383`*^9, 3.601743708675038*^9}, {
   3.60174709657841*^9, 3.6017471120126405`*^9}, {3.601747470709588*^9, 
   3.6017475187794685`*^9}, {3.601747608668086*^9, 3.6017476259964013`*^9}, {
   3.6017501667350793`*^9, 3.601750203845697*^9}, {3.6017505735281224`*^9, 
   3.60175058506277*^9}, {3.6017524236478586`*^9, 3.6017524647211056`*^9}, {
   3.6017524985686693`*^9, 3.601752503533963*^9}, {3.601752536074554*^9, 
   3.601752567687518*^9}, {3.6017526010406404`*^9, 3.601752612389165*^9}, {
   3.6017526906079597`*^9, 3.60175269420835*^9}, {3.6017527246405325`*^9, 
   3.6017527450130453`*^9}, {3.6017533584475527`*^9, 3.601753358863826*^9}, {
   3.6017539662303963`*^9, 3.6017539936946106`*^9}, {3.6017543563039317`*^9, 
   3.6017543895980144`*^9}, {3.6017544265435205`*^9, 3.601754446667865*^9}, {
   3.601754644714301*^9, 3.601754645037512*^9}, {3.6017547599137807`*^9, 
   3.601754767480798*^9}, {3.601756610901582*^9, 3.6017566410715923`*^9}, {
   3.6017576543297377`*^9, 3.6017576575318637`*^9}, {3.6017586908937187`*^9, 
   3.601758693994776*^9}, {3.601759564540083*^9, 3.6017595723352547`*^9}, {
   3.6018251247272625`*^9, 3.601825135567624*^9}, {3.601825757674514*^9, 
   3.601825757731552*^9}, {3.601826003100039*^9, 3.6018260087768035`*^9}, {
   3.601826390021199*^9, 3.601826399634445*^9}, {3.601826884517501*^9, 
   3.6018269082476954`*^9}, {3.601827237898689*^9, 3.601827286492056*^9}, {
   3.6018313948556395`*^9, 3.6018314013779635`*^9}, {3.601833237970101*^9, 
   3.6018332806414046`*^9}, 3.6018333227233133`*^9, {3.6018335879848127`*^9, 
   3.6018335897780075`*^9}, {3.6018348755071964`*^9, 
   3.6018348892332993`*^9}, {3.6018349684129405`*^9, 3.601834973319069*^9}, {
   3.601835018650135*^9, 3.601835019878953*^9}, {3.60183512253607*^9, 
   3.6018351301291075`*^9}, {3.601835610112056*^9, 3.601835616266137*^9}, {
   3.6018371906232224`*^9, 3.6018372133104725`*^9}, {3.6018377806251907`*^9, 
   3.6018377960774393`*^9}, 3.6018388379120173`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakeDensePlot", "[", 
   RowBox[{"Ham_", ",", "levels_"}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Plotarray", ",", "energy", ",", "Plots"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Plotarray", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"index", ",", "1", ",", 
          RowBox[{"Abs", "@", "levels"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Plots", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"k2", " ", "=", " ", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{"i", ",", "40"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"k1", "=", 
            RowBox[{"SetPrecision", "[", 
             RowBox[{"j", ",", "40"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"energy", " ", "=", " ", 
            RowBox[{"SetPrecision", "[", 
             RowBox[{
              RowBox[{"Eigenvalues", "[", 
               RowBox[{
                RowBox[{"N", "@", "Ham"}], ",", 
                RowBox[{"-", "1"}]}], "]"}], ",", "40"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"Plots", ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"N", "@", "k1"}], ",", 
                  RowBox[{"N", "@", "k2"}], ",", 
                  RowBox[{"energy", "[", 
                   RowBox[{"[", "d", "]"}], "]"}]}], "}"}]}], "]"}], ";"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"d", ",", "1", ",", 
               RowBox[{"Length", "@", "energy"}]}], "}"}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", 
            RowBox[{
             RowBox[{"-", "2"}], "\[Pi]"}], ",", 
            RowBox[{"2", "\[Pi]"}], ",", 
            RowBox[{"\[Pi]", "/", "50"}]}], "}"}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"-", "2"}], "\[Pi]"}], ",", 
         RowBox[{"2", "\[Pi]"}], ",", 
         RowBox[{"\[Pi]", "/", "50"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "Plots", "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.601838846673829*^9, 3.6018389370607786`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"k1", ",", "k2"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"firstlevel", "=", 
  RowBox[{"MakeDensePlot", "[", 
   RowBox[{"garbage", ",", 
    RowBox[{"-", "1"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6018389421711693`*^9, 3.601838950954999*^9}, {
  3.601839053955929*^9, 3.6018390597357626`*^9}, {3.6018390984104133`*^9, 
  3.6018391028753753`*^9}}],

Cell[BoxData[
 RowBox[{"ListDensityPlot", "[", "firstlevel", "]"}]], "Input",
 CellChangeTimes->{{3.601840944860305*^9, 3.601840951107448*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"k1", ",", "k2"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"animate4", " ", "=", " ", 
    RowBox[{"Quiet", "@", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"MakePlot", "[", 
        RowBox[{"garbage", ",", 
         RowBox[{"-", "100"}]}], "]"}], ",", "1"}], "]"}]}]}], ";"}], "//", 
  "AbsoluteTiming"}]}], "Input",
 CellChangeTimes->{{3.6018349841522536`*^9, 3.6018349874704566`*^9}, {
  3.601835134398942*^9, 3.601835134488*^9}, {3.6018372299745283`*^9, 
  3.6018372300335646`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1045.58547169999997095146682113409042358398`9.039959453417953", ",", 
   "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.601835061389515*^9, 3.601835282292101*^9, 
  3.6018366230786304`*^9, 3.601838276707756*^9}]
}, Open  ]],

Cell[BoxData["230"], "Input",
 CellChangeTimes->{{3.6017576669370985`*^9, 3.601757667092201*^9}, {
  3.601826405552373*^9, 3.601826408789519*^9}, {3.6018269239213166`*^9, 
  3.6018269251081047`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"MakePlot2", "[", 
   RowBox[{"Ham_", ",", "levels_"}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"Plotarray", ",", "energy", ",", "Plots"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Plots", " ", "=", " ", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Plotarray", " ", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"index", ",", "1", ",", 
          RowBox[{"Abs", "@", "levels"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ParallelTable", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"k2", " ", "=", " ", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{"i", ",", "40"}], "]"}]}], ";", "\[IndentingNewLine]", " ", 
        
        RowBox[{"k1", "=", " ", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{"j", ",", "40"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"energy", " ", "=", " ", 
         RowBox[{"SetPrecision", "[", 
          RowBox[{
           RowBox[{"Eigenvalues", "[", 
            RowBox[{
             RowBox[{"N", "@", "Ham"}], ",", "levels"}], "]"}], ",", "40"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{
             RowBox[{"Plotarray", "[", 
              RowBox[{"[", "d", "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"N", "@", "k1"}], ",", 
               RowBox[{"energy", "[", 
                RowBox[{"[", "d", "]"}], "]"}]}], "}"}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "1", ",", 
            RowBox[{"Length", "@", "energy"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Plotarray", " ", "=", " ", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"index", ",", "1", ",", 
             RowBox[{"Abs", "@", "levels"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"Plots", ",", "\[IndentingNewLine]", 
          RowBox[{"ListLinePlot", "[", 
           RowBox[{"Plotarray", ",", " ", "\[IndentingNewLine]", 
            RowBox[{"Ticks", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{"Range", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], "\[Pi]"}], ",", 
                RowBox[{"2", "\[Pi]"}], ",", "\[Pi]"}], "]"}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"ImageSize", "\[Rule]", " ", 
             RowBox[{"{", "600", "}"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"PlotRange", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], "\[Pi]"}], ",", 
                 RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "100"}], "}"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"AxesLabel", " ", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
              "\"\<\!\(\*SubscriptBox[\(k\), \(2\)]\)\>\"", ",", 
               "\"\<Energy\>\""}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{
          RowBox[{"-", "2"}], "\[Pi]"}], ",", 
         RowBox[{"2", "\[Pi]"}], ",", "\[Pi]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", 
         RowBox[{
          RowBox[{"-", "2"}], "\[Pi]"}], ",", 
         RowBox[{"2", "\[Pi]"}], ",", "\[Pi]"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", "Plots", "}"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",\

 CellChangeTimes->{{3.601833800996358*^9, 3.6018338236974125`*^9}, {
  3.6018339037795286`*^9, 3.601834156081091*^9}, {3.601834244217546*^9, 
  3.601834262780858*^9}, {3.601834340103265*^9, 3.6018343554714565`*^9}, {
  3.60183443396852*^9, 3.6018344424101243`*^9}, {3.6018344764316835`*^9, 
  3.6018344924793277`*^9}, {3.6018346087371483`*^9, 3.6018346176850834`*^9}, {
  3.6018347020046406`*^9, 3.6018347133581734`*^9}, {3.601834754460432*^9, 
  3.6018348366359344`*^9}, {3.6018371662610645`*^9, 3.6018371772723722`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6018342659579654`*^9, 3.6018342707031145`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6018343956531076`*^9, 3.6018343961554413`*^9}}],

Cell[BoxData[
 RowBox[{"ListAnimate", "[", "animate", "]"}]], "Input",
 CellChangeTimes->{{3.601742157808951*^9, 3.6017421585064135`*^9}, {
  3.601742421911275*^9, 3.6017424467261353`*^9}}]
},
WindowSize->{1904, 943},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification->1.100000023841858,
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 277, 5, 32, "Text"],
Cell[837, 27, 1583, 37, 133, "Input"],
Cell[2423, 66, 3687, 74, 253, "Input"],
Cell[6113, 142, 1886, 30, 32, "Input"],
Cell[CellGroupData[{
Cell[8024, 176, 150, 3, 32, "Input"],
Cell[8177, 181, 356, 10, 33, "Output"]
}, Open  ]],
Cell[8548, 194, 137, 3, 32, "Text"],
Cell[8688, 199, 542, 12, 32, "Input"],
Cell[9233, 213, 1328, 33, 58, "Input"],
Cell[CellGroupData[{
Cell[10586, 250, 395, 7, 32, "Input"],
Cell[10984, 259, 570, 13, 33, "Output"]
}, Open  ]],
Cell[11569, 275, 1856, 50, 173, "Input"],
Cell[13428, 327, 4047, 98, 347, "Input"],
Cell[17478, 427, 4472, 109, 306, "Input"],
Cell[CellGroupData[{
Cell[21975, 540, 186, 4, 32, "Input"],
Cell[22164, 546, 391, 10, 33, "Output"]
}, Open  ]],
Cell[22570, 559, 6040, 123, 373, "Input"],
Cell[28613, 684, 2033, 45, 253, "Input"],
Cell[30649, 731, 334, 7, 32, "Input"],
Cell[30986, 740, 626, 14, 53, "Input"],
Cell[31615, 756, 1463, 32, 133, "Input"],
Cell[33081, 790, 3043, 69, 293, "Input"],
Cell[36127, 861, 1889, 39, 173, "Input"],
Cell[38019, 902, 1820, 45, 253, "Input"],
Cell[39842, 949, 902, 20, 32, "Input"],
Cell[40747, 971, 186, 4, 53, "Input"],
Cell[CellGroupData[{
Cell[40958, 979, 466, 9, 32, "Input"],
Cell[41427, 990, 449, 14, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41913, 1009, 175, 4, 32, "Input"],
Cell[42091, 1015, 464, 13, 33, "Output"]
}, Open  ]],
Cell[42570, 1031, 431, 14, 32, "Input"],
Cell[CellGroupData[{
Cell[43026, 1049, 439, 10, 32, "Input"],
Cell[43468, 1061, 490, 9, 33, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43995, 1075, 366, 7, 32, "Input"],
Cell[44364, 1084, 417, 8, 33, "Output"]
}, Open  ]],
Cell[44796, 1095, 7915, 158, 453, "Input"],
Cell[52714, 1255, 2775, 72, 293, "Input"],
Cell[55492, 1329, 425, 10, 53, "Input"],
Cell[55920, 1341, 143, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[56088, 1347, 594, 16, 53, "Input"],
Cell[56685, 1365, 256, 6, 33, "Output"]
}, Open  ]],
Cell[56956, 1374, 199, 3, 32, "Input"],
Cell[57158, 1379, 4683, 112, 453, "Input"],
Cell[61844, 1493, 96, 1, 32, "Input"],
Cell[61943, 1496, 96, 1, 32, "Input"],
Cell[62042, 1499, 189, 3, 32, "Input"]
}
]
*)

(* End of internal cache information *)
